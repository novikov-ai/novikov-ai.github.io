---
title: –£—Å–∫–æ—Ä—è–µ–º –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –Ω–∞ 50% 
slug: postgresql-query-optimization-composite-index           
date: 2025-03-10T22:29:35+03:00
draft: false                                 
params:
  author: –ê–ª–µ–∫—Å–∞–Ω–¥—Ä –ù–æ–≤–∏–∫–æ–≤                  
  ShowCodeCopyButtons: true
  ShowPostNavLinks: true
  tags: [db, postgres, sql, optimization]      
weight: 10
layout: custom-layout                                   
---

–ü—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å PostgreSQL –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤ ‚Äî —ç—Ç–æ –∫–ª—é—á–µ–≤–æ–π –Ω–∞–≤—ã–∫ –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∞–Ω–∏—è –≤—ã—Å–æ–∫–æ–π –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –≤ —Å–∏—Å—Ç–µ–º–∞—Ö —Å –±–æ–ª—å—à–æ–π –Ω–∞–≥—Ä—É–∑–∫–æ–π.

–í —ç—Ç–æ–π —Å—Ç–∞—Ç—å–µ —è –ø–æ–∫–∞–∂—É, –∫–∞–∫ —É–¥–∞–ª–æ—Å—å —Å–æ–∫—Ä–∞—Ç–∏—Ç—å –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –º–µ–¥–ª–µ–Ω–Ω–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞ –Ω–∞ 50% —Å –ø–æ–º–æ—â—å—é **—Å–æ—Å—Ç–∞–≤–Ω–æ–≥–æ –∏–Ω–¥–µ–∫—Å–∞** ‚Äî –∏—Å–ø–æ–ª—å–∑—É—è –∫–æ–º–∞–Ω–¥—ã PostgreSQL `EXPLAIN` –∏ `EXPLAIN ANALYZE` –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏ —É–∑–∫–∏—Ö –º–µ—Å—Ç –≤ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∏ –ø–æ–≤—ã—à–µ–Ω–∏—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏.

## **–ü–æ—á–µ–º—É –∫–æ–º–∞–Ω–¥–∞ EXPLAIN –≤–∞–∂–Ω–∞**

[PostgreSQL](https://www.postgresql.org/docs/current/sql-explain.html) –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –∫–æ–º–∞–Ω–¥—É `EXPLAIN` –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –ø–ª–∞–Ω–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–ø—Ä–æ—Å–∞ **–¥–æ –µ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è**. –≠—Ç–æ –ø–æ–º–æ–≥–∞–µ—Ç —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞–º –ø–æ–Ω—è—Ç—å:

‚úÖ –ö–∞–∫ PostgreSQL **–ø–ª–∞–Ω–∏—Ä—É–µ—Ç** –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–∞  
‚úÖ –ö–∞–∫–∏–µ **–∏–Ω–¥–µ–∫—Å—ã** –∏ —Ç–∏–ø—ã —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è (Seq Scan, Index Scan, Bitmap Scan) –±—É–¥—É—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è  
‚úÖ –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω –ª–∏ –∑–∞–ø—Ä–æ—Å –∏–ª–∏ —Ç—Ä–µ–±—É–µ—Ç—Å—è –¥–æ—Ä–∞–±–æ—Ç–∫–∞

–° –ø–æ–º–æ—â—å—é `EXPLAIN ANALYZE` –º–æ–∂–Ω–æ –ø–æ–π—Ç–∏ –¥–∞–ª—å—à–µ ‚Äî —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏ **–≤—ã–ø–æ–ª–Ω–∏—Ç—å –∑–∞–ø—Ä–æ—Å** –∏ –∏–∑–º–µ—Ä–∏—Ç—å —Ä–µ–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è –µ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è. –û–¥–Ω–∞–∫–æ —Å—Ç–æ–∏—Ç –ø–æ–º–Ω–∏—Ç—å, —á—Ç–æ —ç—Ç–∞ **–∫–æ–º–∞–Ω–¥–∞ –≤—ã–ø–æ–ª–Ω—è–µ—Ç –∑–∞–ø—Ä–æ—Å**, —á—Ç–æ —Ç—Ä–µ–±—É–µ—Ç —Å–æ–±–ª—é–¥–µ–Ω–∏—è —Ä—è–¥–∞ –ø—Ä–µ–¥–æ—Å—Ç–æ—Ä–æ–∂–Ω–æ—Å—Ç–µ–π.

---

## –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –º–µ–¥–ª–µ–Ω–Ω–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞

### **–ü—Ä–æ–±–ª–µ–º–∞**

–Ø —Å—Ç–æ–ª–∫–Ω—É–ª—Å—è —Å –ø—Ä–æ–±–ª–µ–º–æ–π –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –ø—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ —Å–ª–µ–¥—É—é—â–µ–≥–æ –∑–∞–ø—Ä–æ—Å–∞:

```sql
SELECT *
FROM backlog bl
JOIN backlog_element elem ON elem.backlog_id = bl.id
WHERE elem.backlog_id = 1168201980 AND elem.deleted_at IS NULL;
```

### **–®–∞–≥ 1: –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ EXPLAIN**

```sql
EXPLAIN ANALYZE
SELECT *
FROM backlog bl
JOIN backlog_element elem ON elem.backlog_id = bl.id
WHERE elem.backlog_id = 1168201980 AND elem.deleted_at IS NULL;
```

–¢–∞–∫–∂–µ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ: `FORMAT { TEXT | XML | JSON | YAML }`. 

–ü—Ä–∏–º–µ—Ä: `EXPLAIN (ANALYZE, FORMAT TEXT)`.

**–£–ø—Ä–æ—â—ë–Ω–Ω—ã–π –≤—ã–≤–æ–¥ –ø–ª–∞–Ω–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:**

```
Nested Loop  (cost=0.10..32.99 rows=4 width=85) (actual time=0.056..123.456 rows=3 loops=1)
  ->  Index Scan using uidx_elem_backlog_id on backlog bl  (cost=0.05..2.65 rows=1 width=8) (actual time=0.034..0.035 rows=1 loops=1)
        Index Cond: (backlog_id = '1168201980'::bigint)
  ->  Index Scan using idx_backlog_element_backlog_id on backlog_element elem  (cost=0.05..30.32 rows=13 width=93) (actual time=0.019..123.421 rows=3 loops=1)
        Index Cond: (backlog_id = bl.id)
        Filter: (deleted_at IS NULL)
        Rows Removed by Filter: 2
Planning time: 0.309 ms
Execution time: 123.456 ms
```

### üìî –ö–∞–∫ —á–∏—Ç–∞—Ç—å –≤—ã–≤–æ–¥

1. **–í–µ—Ä—Ö–Ω–∏–π —É—Ä–æ–≤–µ–Ω—å: Nested Loop**
   - **Cost**: `(cost=0.10..32.99 rows=4 width=85)`
     - `cost=0.10..32.99`: –û—Ü–µ–Ω–æ—á–Ω–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å –æ–ø–µ—Ä–∞—Ü–∏–∏ (–µ–¥–∏–Ω–∏—Ü—ã –∏–∑–º–µ—Ä–µ–Ω–∏—è —É—Å–ª–æ–≤–Ω—ã, –æ–±—ã—á–Ω–æ –æ—Ç—Ä–∞–∂–∞—é—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–±—Ä–∞—â–µ–Ω–∏–π –∫ –¥–∏—Å–∫–æ–≤—ã–º —Å—Ç—Ä–∞–Ω–∏—Ü–∞–º).
     - `rows=4`: –û—Ü–µ–Ω–æ—á–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤–æ–∑–≤—Ä–∞—â–∞–µ–º—ã—Ö —Å—Ç—Ä–æ–∫.
     - `width=85`: –û—Ü–µ–Ω–æ—á–Ω–∞—è —à–∏—Ä–∏–Ω–∞ –∫–∞–∂–¥–æ–π —Å—Ç—Ä–æ–∫–∏ (–≤ –±–∞–π—Ç–∞—Ö).
   - **Actual Time**: `(actual time=0.056..123.456 rows=3 loops=1)`
     - `actual time=0.056..123.456`: –§–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –≤—Ä–µ–º—è –Ω–∞—á–∞–ª–∞ –∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –æ–ø–µ—Ä–∞—Ü–∏–∏.
     - `rows=3`: –§–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤–æ–∑–≤—Ä–∞—â–∞–µ–º—ã—Ö —Å—Ç—Ä–æ–∫.
     - `loops=1`: –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø—É—Å–∫–æ–≤ –¥–∞–Ω–Ω–æ–π –æ–ø–µ—Ä–∞—Ü–∏–∏.

2. **–ü–µ—Ä–≤—ã–π –¥–æ—á–µ—Ä–Ω–∏–π —É–∑–µ–ª: Index Scan –ø–æ —Ç–∞–±–ª–∏—Ü–µ `backlog`**
   - **Cost**: `(cost=0.05..2.65 rows=1 width=8)`
     - `cost=0.05..2.65`: –û—Ü–µ–Ω–æ—á–Ω–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å.
     - `rows=1`: –û—Ü–µ–Ω–æ—á–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—Ä–æ–∫.
     - `width=8`: –û—Ü–µ–Ω–æ—á–Ω–∞—è —à–∏—Ä–∏–Ω–∞ –∫–∞–∂–¥–æ–π —Å—Ç—Ä–æ–∫–∏.
   - **Actual Time**: `(actual time=0.034..0.035 rows=1 loops=1)`
     - `actual time=0.034..0.035`: –§–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è.
     - `rows=1`: –§–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—Ä–æ–∫.
     - `loops=1`: –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø—É—Å–∫–æ–≤.
   - **Index Cond**: `(backlog_id = '1168201980'::bigint)`
     - –£—Å–ª–æ–≤–∏–µ, –ø—Ä–∏–º–µ–Ω—è–µ–º–æ–µ –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ —Å—Ç—Ä–æ–∫.

3. **–í—Ç–æ—Ä–æ–π –¥–æ—á–µ—Ä–Ω–∏–π —É–∑–µ–ª: Index Scan –ø–æ —Ç–∞–±–ª–∏—Ü–µ `backlog_element`**
   - **Cost**: `(cost=0.05..30.32 rows=13 width=93)`
     - `cost=0.05..30.32`: –û—Ü–µ–Ω–æ—á–Ω–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å.
     - `rows=13`: –û—Ü–µ–Ω–æ—á–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—Ä–æ–∫.
     - `width=93`: –û—Ü–µ–Ω–æ—á–Ω–∞—è —à–∏—Ä–∏–Ω–∞ –∫–∞–∂–¥–æ–π —Å—Ç—Ä–æ–∫–∏.
   - **Actual Time**: `(actual time=0.019..123.421 rows=3 loops=1)`
     - `actual time=0.019..123.421`: –§–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è.
     - `rows=3`: –§–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—Ä–æ–∫.
     - `loops=1`: –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø—É—Å–∫–æ–≤.
   - **Index Cond**: `(backlog_id = bl.id)`
     - –£—Å–ª–æ–≤–∏–µ –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ —Å—Ç—Ä–æ–∫.
   - **Filter**: `(deleted_at IS NULL)`
     - –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–µ —É—Å–ª–æ–≤–∏–µ –¥–ª—è –∏—Å–∫–ª—é—á–µ–Ω–∏—è —Å—Ç—Ä–æ–∫.
   - **Rows Removed by Filter**: `2`
     - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—Ä–æ–∫, –∏—Å–∫–ª—é—á—ë–Ω–Ω—ã—Ö —Ñ–∏–ª—å—Ç—Ä–æ–º.

4. **–í—Ä–µ–º—è –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è**
   - **Planning time**: `0.309 ms`
     - –í—Ä–µ–º—è, –∑–∞—Ç—Ä–∞—á–µ–Ω–Ω–æ–µ –Ω–∞ —Å–æ–∑–¥–∞–Ω–∏–µ –ø–ª–∞–Ω–∞ –∑–∞–ø—Ä–æ—Å–∞.
   - **Execution time**: `123.456 ms`
     - –û–±—â–µ–µ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–ø—Ä–æ—Å–∞.

### **–û—Å–Ω–æ–≤–Ω—ã–µ –≤—ã–≤–æ–¥—ã –∏–∑ –ø–ª–∞–Ω–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:**

1. **Nested Loop Join**: –ó–∞–ø—Ä–æ—Å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –≤–ª–æ–∂–µ–Ω–Ω–æ–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –¥–ª—è –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏—è —Å—Ç—Ä–æ–∫ –∏–∑ —Ç–∞–±–ª–∏—Ü `backlog` –∏ `backlog_element`.
2. **–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∏–Ω–¥–µ–∫—Å–æ–≤**: 
   - –¢–∞–±–ª–∏—Ü–∞ `backlog` —Å–∫–∞–Ω–∏—Ä—É–µ—Ç—Å—è —Å –ø–æ–º–æ—â—å—é –∏–Ω–¥–µ–∫—Å–∞ `uidx_elem_backlog_id` –¥–ª—è –ø–æ–∏—Å–∫–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ `backlog_id`.
   - –¢–∞–±–ª–∏—Ü–∞ `backlog_element` —Å–∫–∞–Ω–∏—Ä—É–µ—Ç—Å—è —Å –ø–æ–º–æ—â—å—é –∏–Ω–¥–µ–∫—Å–∞ `idx_backlog_element_backlog_id` –¥–ª—è –ø–æ–∏—Å–∫–∞ —Å—Ç—Ä–æ–∫, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏—Ö `backlog_id` –∏–∑ —Ç–∞–±–ª–∏—Ü—ã `backlog`.
3. **–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è**:
   - –í —Ç–∞–±–ª–∏—Ü–µ `backlog_element` —Å—Ç—Ä–æ–∫–∏ —Ñ–∏–ª—å—Ç—Ä—É—é—Ç—Å—è –¥–ª—è –∏—Å–∫–ª—é—á–µ–Ω–∏—è —Ç–µ—Ö, —É –∫–æ—Ç–æ—Ä—ã—Ö –ø–æ–ª–µ `deleted_at` –Ω–µ —Ä–∞–≤–Ω–æ NULL.
   - –ò–∑ 5 –ø–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω–æ –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö —Å—Ç—Ä–æ–∫ 2 –±—ã–ª–∏ –∏—Å–∫–ª—é—á–µ–Ω—ã –∏–∑-–∑–∞ —É—Å–ª–æ–≤–∏—è —Ñ–∏–ª—å—Ç—Ä–∞, –≤ –∏—Ç–æ–≥–µ –±—ã–ª–æ –≤–æ–∑–≤—Ä–∞—â–µ–Ω–æ 3 —Å—Ç—Ä–æ–∫–∏.

---

## **–®–∞–≥ 2: –°–æ–∑–¥–∞–Ω–∏–µ —Å–æ—Å—Ç–∞–≤–Ω–æ–≥–æ –∏–Ω–¥–µ–∫—Å–∞**

**–°–æ—Å—Ç–∞–≤–Ω–æ–π –∏–Ω–¥–µ–∫—Å** –ø–æ –ø–æ–ª—è–º `(backlog_id, deleted_at)` –ø–æ–º–æ–≥–∞–µ—Ç, –ø–æ—Å–∫–æ–ª—å–∫—É:

- –û–Ω –ø–æ–∑–≤–æ–ª—è–µ—Ç PostgreSQL **–±—ã—Å—Ç—Ä–æ –Ω–∞—Ö–æ–¥–∏—Ç—å —Å—Ç—Ä–æ–∫–∏** —Å `backlog_id = 1168201980`.
- –ë–ª–∞–≥–æ–¥–∞—Ä—è –≤–∫–ª—é—á–µ–Ω–∏—é –ø–æ–ª—è `deleted_at` –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–∞—è **—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –¥–∞—Ç–µ** –∏ **—Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤**.

```sql
CREATE INDEX idx_backlog_element_deleted ON backlog_element (backlog_id, deleted_at DESC);
```

---

## **–®–∞–≥ 3: –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ —Å –ø–æ–º–æ—â—å—é EXPLAIN ANALYZE**

```sql
EXPLAIN ANALYZE
SELECT *
FROM backlog bl
JOIN backlog_element elem ON elem.backlog_id = bl.id
WHERE elem.backlog_id = 1168201980 AND elem.deleted_at IS NULL;
```

üîç **–û–±–Ω–æ–≤–ª—ë–Ω–Ω—ã–π –≤—ã–≤–æ–¥ –ø–ª–∞–Ω–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:**

```
Nested Loop  (cost=0.30..16.35 rows=1 width=113) (actual time=0.042..61.728 rows=1 loops=1)
  ->  Index Scan using uidx_elem_backlog_id on backlog bl  (cost=0.15..8.17 rows=1 width=8) (actual time=0.029..0.030 rows=1 loops=1)
        Index Cond: (backlog_id = 1)
  ->  Index Scan using idx_backlog_element_active on backlog_element elem  (cost=0.15..8.17 rows=1 width=121) (actual time=0.012..61.696 rows=1 loops=1)
        Index Cond: ((backlog_id = bl.id) AND (deleted_at IS NULL))  -- –≠—Ç–∞–ø —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç!
Planning time: 0.309 ms
Execution time: 61.728 ms
```

### **–£—Å–∫–æ—Ä–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏** üöÄ

‚úÖ **–°–æ–∫—Ä–∞—â–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –Ω–∞ 50%**: –í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–ø—Ä–æ—Å–∞ —Å–æ–∫—Ä–∞—Ç–∏–ª–æ—Å—å —Å **124ms ‚Üí 62ms**  
‚úÖ **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Index Scan**: PostgreSQL —Ç–µ–ø–µ—Ä—å —Å–∫–∞–Ω–∏—Ä—É–µ—Ç —Ç–æ–ª—å–∫–æ **—Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ–µ –ø–æ–¥–º–Ω–æ–∂–µ—Å—Ç–≤–æ** –¥–∞–Ω–Ω—ã—Ö  
‚úÖ **–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–∞—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞**: –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ –Ω–µ —Ç—Ä–µ–±—É—é—Ç—Å—è

---

## ‚ö†Ô∏è **–ü—Ä–µ–¥–æ—Å—Ç–µ—Ä–µ–∂–µ–Ω–∏—è –ø—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ EXPLAIN ANALYZE**

–•–æ—Ç—è `EXPLAIN ANALYZE` ‚Äî –º–æ—â–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç, –æ–Ω –∏–º–µ–µ—Ç –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:

- **–ü–æ–±–æ—á–Ω—ã–µ —ç—Ñ—Ñ–µ–∫—Ç—ã**:  
  `EXPLAIN ANALYZE` –≤—ã–ø–æ–ª–Ω—è–µ—Ç –∑–∞–ø—Ä–æ—Å, —á—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –µ—Å–ª–∏ –∑–∞–ø—Ä–æ—Å –Ω–µ —è–≤–ª—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –¥–ª—è —á—Ç–µ–Ω–∏—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Å–æ–¥–µ—Ä–∂–∏—Ç INSERT, UPDATE –∏–ª–∏ DELETE), –æ–Ω –º–æ–∂–µ—Ç **–∏–∑–º–µ–Ω–∏—Ç—å** –¥–∞–Ω–Ω—ã–µ. –í—Å–µ–≥–¥–∞ –∑–∞–ø—É—Å–∫–∞–π—Ç–µ –µ–≥–æ –≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ–π —Ç–µ—Å—Ç–æ–≤–æ–π —Å—Ä–µ–¥–µ –∏–ª–∏ –ø—Ä–∏–º–µ–Ω—è–π—Ç–µ –∫ –∑–∞–ø—Ä–æ—Å–∞–º —Ç–æ–ª—å–∫–æ –¥–ª—è —á—Ç–µ–Ω–∏—è.

  üí° –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `EXPLAIN ANALYZE` –≤ —Ä–∞–º–∫–∞—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏, –µ—Å–ª–∏ –∑–∞–ø—Ä–æ—Å –∏–∑–º–µ–Ω—è–µ—Ç –¥–∞–Ω–Ω—ã–µ:
  ~~~sql
  BEGIN;
  EXPLAIN ANALYZE ...;
  ROLLBACK;
  ~~~

- **–ó–∞—Ç—Ä–∞—Ç—ã —Ä–µ—Å—É—Ä—Å–æ–≤**:  
  –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Å–ª–æ–∂–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ —Å `EXPLAIN ANALYZE` –Ω–∞ —Ä–∞–±–æ—á–∏—Ö —Å–∏—Å—Ç–µ–º–∞—Ö –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –Ω–µ–æ–∂–∏–¥–∞–Ω–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–µ, —Ç–∞–∫ –∫–∞–∫ –∑–∞–ø—Ä–æ—Å –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –ø–æ–ª–Ω–æ—Å—Ç—å—é. –ü—Ä–∏–º–µ–Ω—è–π—Ç–µ –µ–≥–æ —Å –æ—Å—Ç–æ—Ä–æ–∂–Ω–æ—Å—Ç—å—é –≤ –ø–µ—Ä–∏–æ–¥—ã –ø–∏–∫–æ–≤–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏.

- **–ü—Ä–æ–±–ª–µ–º—ã –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫**:  
  –í –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö —Å–ª—É—á–∞—è—Ö –∑–∞–ø—Ä–æ—Å –º–æ–∂–µ—Ç —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç –ø–æ–º–µ—à–∞—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—é –¥—Ä—É–≥–∏—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π. –û—Ü–µ–Ω–∏—Ç–µ –≤–æ–∑–º–æ–∂–Ω–æ–µ –≤–ª–∏—è–Ω–∏–µ –Ω–∞ –≤–∞—à–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏, –µ—Å–ª–∏ –≤–æ–∑–º–æ–∂–Ω–æ, –ø—Ä–æ–≤–æ–¥–∏—Ç–µ –∞–Ω–∞–ª–∏–∑ –≤ –ø–µ—Ä–∏–æ–¥—ã –Ω–∏–∑–∫–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏.

- **–¢–æ—á–Ω–æ—Å—Ç—å –∏–∑–º–µ—Ä–µ–Ω–∏—è –≤—Ä–µ–º–µ–Ω–∏**:  
  –£–∫–∞–∑–∞–Ω–Ω–æ–µ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –≤–∫–ª—é—á–∞–µ—Ç —Ñ–∞–∑—É –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –º–æ–∂–µ—Ç –Ω–µ –æ—Ç—Ä–∞–∂–∞—Ç—å –≤—Ä–µ–º—è –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –∑–∞–ø—É—Å–∫–æ–≤ –∑–∞–ø—Ä–æ—Å–∞. –î–ª—è –±–æ–ª–µ–µ —Ç–æ—á–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–æ–≤–æ–¥–∏—Ç–µ –Ω–µ—Å–∫–æ–ª—å–∫–æ –∑–∞–º–µ—Ä–æ–≤ –∏ —É—Å—Ä–µ–¥–Ω—è–π—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã.

---

## **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é EXPLAIN –≤ —Ä–µ–∞–ª—å–Ω–æ–π —Ä–∞–±–æ—Ç–µ**

1Ô∏è‚É£ **–ù–∞—á–∏–Ω–∞–π—Ç–µ —Å `EXPLAIN` –ø–µ—Ä–µ–¥ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ–º —Ä–µ—Å—É—Ä—Å–æ—ë–º–∫–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤**: –ï—Å–ª–∏ –∑–∞–ø—Ä–æ—Å —Ä–∞–±–æ—Ç–∞–µ—Ç –º–µ–¥–ª–µ–Ω–Ω–æ, —Å–Ω–∞—á–∞–ª–∞ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –µ–≥–æ –ø–ª–∞–Ω –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è.

2Ô∏è‚É£ **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `EXPLAIN ANALYZE` –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ —Ä–µ–∞–ª—å–Ω–æ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è**: –û–Ω –∏–∑–º–µ—Ä—è–µ—Ç —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è, –Ω–æ **–≤—ã–ø–æ–ª–Ω—è–µ—Ç –∑–∞–ø—Ä–æ—Å**. –ë—É–¥—å—Ç–µ –æ—Å—Ç–æ—Ä–æ–∂–Ω—ã –ø—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ –Ω–∞ —Ä–∞–±–æ—á–∏—Ö –±–∞–∑–∞—Ö.

3Ô∏è‚É£ **–û–±—Ä–∞—â–∞–π—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ `Seq Scan` –≤ –±–æ–ª—å—à–∏—Ö —Ç–∞–±–ª–∏—Ü–∞—Ö**: –ï—Å–ª–∏ –æ–±–Ω–∞—Ä—É–∂–∏–≤–∞–µ—Ç—Å—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ–µ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –±–æ–ª—å—à–æ–π —Ç–∞–±–ª–∏—Ü—ã, **–ø–æ–¥—É–º–∞–π—Ç–µ –æ–± –∏–Ω–¥–µ–∫—Å–∏—Ä–æ–≤–∞–Ω–∏–∏**.

4Ô∏è‚É£ **–ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∏–Ω–¥–µ–∫—Å–æ–≤ PostgreSQL**: –ò–Ω–æ–≥–¥–∞ –∏–Ω–¥–µ–∫—Å—ã —Å—É—â–µ—Å—Ç–≤—É—é—Ç, –Ω–æ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –∏–∑-–∑–∞ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–µ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –∑–∞–ø—Ä–æ—Å–∞.

5Ô∏è‚É£ **–†–∞–∑—É–º–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å–æ—Å—Ç–∞–≤–Ω—ã—Ö –∏–Ω–¥–µ–∫—Å–æ–≤**: –ò–Ω–¥–µ–∫—Å—ã –ø–æ `(A, B)` –Ω–∞–∏–±–æ–ª–µ–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã, –∫–æ–≥–¥–∞ —Å–Ω–∞—á–∞–ª–∞ —Ñ–∏–ª—å—Ç—Ä—É–µ—Ç—Å—è –ø–æ **A**, –∞ –∑–∞—Ç–µ–º –ø–æ **B**.

6Ô∏è‚É£ **–ò–∑–±–µ–≥–∞–π—Ç–µ —á—Ä–µ–∑–º–µ—Ä–Ω–æ–≥–æ –∏–Ω–¥–µ–∫—Å–∏—Ä–æ–≤–∞–Ω–∏—è**: –•–æ—Ç—è –∏–Ω–¥–µ–∫—Å—ã —É—Å–∫–æ—Ä—è—é—Ç —á—Ç–µ–Ω–∏–µ, –æ–Ω–∏ –º–æ–≥—É—Ç –∑–∞–º–µ–¥–ª—è—Ç—å –æ–ø–µ—Ä–∞—Ü–∏–∏ –≤—Å—Ç–∞–≤–∫–∏/–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è. –°–æ–∑–¥–∞–≤–∞–π—Ç–µ –∏–Ω–¥–µ–∫—Å—ã —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏.

---

## **–ó–∞–∫–ª—é—á–µ–Ω–∏–µ**

–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ PostgreSQL —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º `EXPLAIN` ‚Äî —ç—Ç–æ –º–æ—â–Ω—ã–π –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è backend-—Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤. –í –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ, –¥–æ–±–∞–≤–∏–≤ **—Å–æ—Å—Ç–∞–≤–Ω–æ–π –∏–Ω–¥–µ–∫—Å**, —É–¥–∞–ª–æ—Å—å —Å–æ–∫—Ä–∞—Ç–∏—Ç—å –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–ø—Ä–æ—Å–∞ –Ω–∞ **50%**, —á—Ç–æ –ø–æ–≤—ã—Å–∏–ª–æ –æ–±—â—É—é —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å —Å–∏—Å—Ç–µ–º—ã.

*–ß–∏—Ç–∞–π—Ç–µ –¥—Ä—É–≥–∏–µ –ø–æ—Å—Ç—ã –∏ –ø—Ä–∏—Å–æ–µ–¥–∏–Ω—è–π—Ç–µ—Å—å –∫ –æ–±—Å—É–∂–¥–µ–Ω–∏—é —Ç–µ–º—ã –≤ –¢–µ–ª–µ–≥—Ä–∞–º: [@time2code](https://t.me/time2code)*